const std = @import("std");

// @TODO: https://github.com/ziglang/zig/issues/11585

fn stub(comptime str: []const u8) *const anyopaque {
    return @ptrCast(*const anyopaque, struct {
        fn f() noreturn {
            @panic("ntdll stub: " ++ str);
        }
    }.f);
}

pub const builtin_symbols = blk: {
    @setEvalBranchQuota(200000);

    break :blk std.ComptimeStringMap(*const anyopaque, .{
        .{"RtlComputeCrc32", stub("RtlComputeCrc32") },
        .{"RtlUpcaseUnicodeChar", stub("RtlUpcaseUnicodeChar") },
        .{"NtOpenKey", stub("NtOpenKey") },
        .{"RtlGetVersion", stub("RtlGetVersion") },
        .{"NtClose", stub("NtClose") },
        .{"TpAllocTimer", stub("TpAllocTimer") },
        .{"TpSetTimer", stub("TpSetTimer") },
        .{"NtQuerySystemInformation", stub("NtQuerySystemInformation") },
        .{"RtlAllocateHeap", stub("RtlAllocateHeap") },
        .{"RtlFreeHeap", stub("RtlFreeHeap") },
        .{"NtSetValueKey", stub("NtSetValueKey") },
        .{"RtlFreeUnicodeString", stub("RtlFreeUnicodeString") },
        .{"NtDeviceIoControlFile", stub("NtDeviceIoControlFile") },
        .{"NtQueryValueKey", stub("NtQueryValueKey") },
        .{"RtlInitUnicodeString", stub("RtlInitUnicodeString") },
        .{"RtlPrefixUnicodeString", stub("RtlPrefixUnicodeString") },
        .{"NtOpenFile", stub("NtOpenFile") },
        .{"NtQueryVolumeInformationFile", stub("NtQueryVolumeInformationFile") },
        .{"NtQueryInformationProcess", stub("NtQueryInformationProcess") },
        .{"RtlInitUnicodeStringEx", stub("RtlInitUnicodeStringEx") },
        .{"_vsnwprintf_s", stub("_vsnwprintf_s") },
        .{"NtCreatePagingFile", stub("NtCreatePagingFile") },
        .{"NtSetSystemInformation", stub("NtSetSystemInformation") },
        .{"RtlAppendUnicodeToString", stub("RtlAppendUnicodeToString") },
        .{"RtlSecondsSince1970ToTime", stub("RtlSecondsSince1970ToTime") },
        .{"qsort", stub("qsort") },
        .{"NtSetInformationFile", stub("NtSetInformationFile") },
        .{"NtQueryInformationFile", stub("NtQueryInformationFile") },
        .{"NtFsControlFile", stub("NtFsControlFile") },
        .{"RtlCompareUnicodeString", stub("RtlCompareUnicodeString") },
        .{"RtlAppendUnicodeStringToString", stub("RtlAppendUnicodeStringToString") },
        .{"RtlCompareMemory", stub("RtlCompareMemory") },
        .{"NtDeleteValueKey", stub("NtDeleteValueKey") },
        .{"NtFlushKey", stub("NtFlushKey") },
        .{"NtUpdateWnfStateData", stub("NtUpdateWnfStateData") },
        .{"NtSerializeBoot", stub("NtSerializeBoot") },
        .{"RtlUnicodeStringToInteger", stub("RtlUnicodeStringToInteger") },
        .{"RtlAllocateAndInitializeSid", stub("RtlAllocateAndInitializeSid") },
        .{"RtlCreateSecurityDescriptor", stub("RtlCreateSecurityDescriptor") },
        .{"RtlCreateAcl", stub("RtlCreateAcl") },
        .{"RtlAddAccessAllowedAce", stub("RtlAddAccessAllowedAce") },
        .{"RtlSetDaclSecurityDescriptor", stub("RtlSetDaclSecurityDescriptor") },
        .{"RtlSetOwnerSecurityDescriptor", stub("RtlSetOwnerSecurityDescriptor") },
        .{"NtSetSecurityObject", stub("NtSetSecurityObject") },
        .{"RtlExpandEnvironmentStrings_U", stub("RtlExpandEnvironmentStrings_U") },
        .{"RtlDosPathNameToNtPathName_U", stub("RtlDosPathNameToNtPathName_U") },
        .{"NtCreateFile", stub("NtCreateFile") },
        .{"NtReadFile", stub("NtReadFile") },
        .{"NtCreateKey", stub("NtCreateKey") },
        .{"NtAllocateVirtualMemory", stub("NtAllocateVirtualMemory") },
        .{"NtWriteFile", stub("NtWriteFile") },
        .{"NtFreeVirtualMemory", stub("NtFreeVirtualMemory") },
        .{"RtlCreateUnicodeString", stub("RtlCreateUnicodeString") },
        .{"EtwEventWrite", stub("EtwEventWrite") },
        .{"EtwEventEnabled", stub("EtwEventEnabled") },
        .{"_vsnwprintf", stub("_vsnwprintf") },
        .{"RtlCopyUnicodeString", stub("RtlCopyUnicodeString") },
        .{"RtlAddMandatoryAce", stub("RtlAddMandatoryAce") },
        .{"RtlSetSaclSecurityDescriptor", stub("RtlSetSaclSecurityDescriptor") },
        .{"RtlAdjustPrivilege", stub("RtlAdjustPrivilege") },
        .{"RtlFreeSid", stub("RtlFreeSid") },
        .{"RtlLengthSid", stub("RtlLengthSid") },
        .{"NtCreateMutant", stub("NtCreateMutant") },
        .{"RtlCreateTagHeap", stub("RtlCreateTagHeap") },
        .{"NtSetInformationProcess", stub("NtSetInformationProcess") },
        .{"NtAlpcCreatePort", stub("NtAlpcCreatePort") },
        .{"RtlInitializeBitMap", stub("RtlInitializeBitMap") },
        .{"RtlClearAllBits", stub("RtlClearAllBits") },
        .{"RtlSetBits", stub("RtlSetBits") },
        .{"NtOpenEvent", stub("NtOpenEvent") },
        .{"RtlCreateEnvironment", stub("RtlCreateEnvironment") },
        .{"RtlSetCurrentEnvironment", stub("RtlSetCurrentEnvironment") },
        .{"RtlQueryRegistryValuesEx", stub("RtlQueryRegistryValuesEx") },
        .{"NtCreateDirectoryObject", stub("NtCreateDirectoryObject") },
        .{"RtlEqualUnicodeString", stub("RtlEqualUnicodeString") },
        .{"NtSetEvent", stub("NtSetEvent") },
        .{"NtInitializeRegistry", stub("NtInitializeRegistry") },
        .{"NtResumeThread", stub("NtResumeThread") },
        .{"NtWaitForSingleObject", stub("NtWaitForSingleObject") },
        .{"NtTerminateProcess", stub("NtTerminateProcess") },
        .{"TpAllocWork", stub("TpAllocWork") },
        .{"TpPostWork", stub("TpPostWork") },
        .{"TpWaitForWork", stub("TpWaitForWork") },
        .{"TpReleaseWork", stub("TpReleaseWork") },
        .{"_wcsupr_s", stub("_wcsupr_s") },
        .{"NtOpenDirectoryObject", stub("NtOpenDirectoryObject") },
        .{"NtCreateSymbolicLinkObject", stub("NtCreateSymbolicLinkObject") },
        .{"NtMakeTemporaryObject", stub("NtMakeTemporaryObject") },
        .{"_stricmp", stub("_stricmp") },
        .{"RtlInitAnsiString", stub("RtlInitAnsiString") },
        .{"RtlAnsiStringToUnicodeString", stub("RtlAnsiStringToUnicodeString") },
        .{"NtOpenSymbolicLinkObject", stub("NtOpenSymbolicLinkObject") },
        .{"NtQuerySymbolicLinkObject", stub("NtQuerySymbolicLinkObject") },
        .{"RtlDosPathNameToNtPathName_U_WithStatus", stub("RtlDosPathNameToNtPathName_U_WithStatus") },
        .{"RtlRandomEx", stub("RtlRandomEx") },
        .{"qsort_s", stub("qsort_s") },
        .{"LdrVerifyImageMatchesChecksumEx", stub("LdrVerifyImageMatchesChecksumEx") },
        .{"RtlAppxIsFileOwnedByTrustedInstaller", stub("RtlAppxIsFileOwnedByTrustedInstaller") },
        .{"NtQueryAttributesFile", stub("NtQueryAttributesFile") },
        .{"NtQueryDirectoryFile", stub("NtQueryDirectoryFile") },
        .{"RtlDeleteRegistryValue", stub("RtlDeleteRegistryValue") },
        .{"RtlWriteRegistryValue", stub("RtlWriteRegistryValue") },
        .{"_wcsicmp", stub("_wcsicmp") },
        .{"RtlSetEnvironmentVariable", stub("RtlSetEnvironmentVariable") },
        .{"NtCreateSection", stub("NtCreateSection") },
        .{"NtMapViewOfSection", stub("NtMapViewOfSection") },
        .{"NtUnmapViewOfSection", stub("NtUnmapViewOfSection") },
        .{"NtDuplicateObject", stub("NtDuplicateObject") },
        .{"NtQueryInformationJobObject", stub("NtQueryInformationJobObject") },
        .{"iswctype", stub("iswctype") },
        .{"RtlQueryEnvironmentVariable_U", stub("RtlQueryEnvironmentVariable_U") },
        .{"RtlDosSearchPath_U", stub("RtlDosSearchPath_U") },
        .{"RtlTestBit", stub("RtlTestBit") },
        .{"RtlInterlockedSetBitRun", stub("RtlInterlockedSetBitRun") },
        .{"RtlFindSetBits", stub("RtlFindSetBits") },
        .{"RtlCreateProcessParametersEx", stub("RtlCreateProcessParametersEx") },
        .{"RtlCreateUserProcess", stub("RtlCreateUserProcess") },
        .{"RtlDestroyProcessParameters", stub("RtlDestroyProcessParameters") },
        .{"NtDisplayString", stub("NtDisplayString") },
        .{"RtlAddProcessTrustLabelAce", stub("RtlAddProcessTrustLabelAce") },
        .{"RtlGetAce", stub("RtlGetAce") },
        .{"NtQueryDirectoryObject", stub("NtQueryDirectoryObject") },
        .{"RtlTimeToTimeFields", stub("RtlTimeToTimeFields") },
        .{"NtDeleteFile", stub("NtDeleteFile") },
        .{"RtlAcquireSRWLockExclusive", stub("RtlAcquireSRWLockExclusive") },
        .{"NtAlpcDisconnectPort", stub("NtAlpcDisconnectPort") },
        .{"RtlReleaseSRWLockExclusive", stub("RtlReleaseSRWLockExclusive") },
        .{"RtlAcquireSRWLockShared", stub("RtlAcquireSRWLockShared") },
        .{"RtlReleaseSRWLockShared", stub("RtlReleaseSRWLockShared") },
        .{"NtAlpcImpersonateClientOfPort", stub("NtAlpcImpersonateClientOfPort") },
        .{"NtOpenThreadToken", stub("NtOpenThreadToken") },
        .{"NtQueryInformationToken", stub("NtQueryInformationToken") },
        .{"NtSetInformationThread", stub("NtSetInformationThread") },
        .{"TpSetPoolMinThreads", stub("TpSetPoolMinThreads") },
        .{"RtlSetThreadIsCritical", stub("RtlSetThreadIsCritical") },
        .{"AlpcInitializeMessageAttribute", stub("AlpcInitializeMessageAttribute") },
        .{"NtAlpcSendWaitReceivePort", stub("NtAlpcSendWaitReceivePort") },
        .{"AlpcGetMessageAttribute", stub("AlpcGetMessageAttribute") },
        .{"NtAlpcCancelMessage", stub("NtAlpcCancelMessage") },
        .{"NtAlpcOpenSenderProcess", stub("NtAlpcOpenSenderProcess") },
        .{"RtlInitializeSRWLock", stub("RtlInitializeSRWLock") },
        .{"NtAlpcAcceptConnectPort", stub("NtAlpcAcceptConnectPort") },
        .{"NtConnectPort", stub("NtConnectPort") },
        .{"NtRequestWaitReplyPort", stub("NtRequestWaitReplyPort") },
        .{"NtCreateEvent", stub("NtCreateEvent") },
        .{"RtlDeleteNoSplay", stub("RtlDeleteNoSplay") },
        .{"RtlSleepConditionVariableSRW", stub("RtlSleepConditionVariableSRW") },
        .{"RtlWakeAllConditionVariable", stub("RtlWakeAllConditionVariable") },
        .{"NtAssignProcessToJobObject", stub("NtAssignProcessToJobObject") },
        .{"EtwGetTraceLoggerHandle", stub("EtwGetTraceLoggerHandle") },
        .{"EtwGetTraceEnableLevel", stub("EtwGetTraceEnableLevel") },
        .{"EtwGetTraceEnableFlags", stub("EtwGetTraceEnableFlags") },
        .{"EtwRegisterTraceGuidsW", stub("EtwRegisterTraceGuidsW") },
        .{"NtDelayExecution", stub("NtDelayExecution") },
        .{"RtlSetHeapInformation", stub("RtlSetHeapInformation") },
        .{"EtwEventRegister", stub("EtwEventRegister") },
        .{"TpAllocPool", stub("TpAllocPool") },
        .{"TpAllocAlpcCompletion", stub("TpAllocAlpcCompletion") },
        .{"NtWaitForMultipleObjects", stub("NtWaitForMultipleObjects") },
        .{"NtRaiseHardError", stub("NtRaiseHardError") },
        .{"RtlInitializeConditionVariable", stub("RtlInitializeConditionVariable") },
        .{"NtClearEvent", stub("NtClearEvent") },
        .{"RtlUnicodeStringToAnsiString", stub("RtlUnicodeStringToAnsiString") },
        .{"NtQueryEvent", stub("NtQueryEvent") },
        .{"wcstoul", stub("wcstoul") },
        .{"LdrQueryImageFileExecutionOptions", stub("LdrQueryImageFileExecutionOptions") },
        .{"RtlAcquirePrivilege", stub("RtlAcquirePrivilege") },
        .{"RtlReleasePrivilege", stub("RtlReleasePrivilege") },
        .{"RtlCaptureContext", stub("RtlCaptureContext") },
        .{"RtlLookupFunctionEntry", stub("RtlLookupFunctionEntry") },
        .{"RtlVirtualUnwind", stub("RtlVirtualUnwind") },
        .{"RtlUnhandledExceptionFilter", stub("RtlUnhandledExceptionFilter") },
        .{"RtlCompareUnicodeStrings", stub("RtlCompareUnicodeStrings") },
        .{"RtlNormalizeProcessParams", stub("RtlNormalizeProcessParams") },
        .{"iswspace", stub("iswspace") },
        .{"RtlConnectToSm", stub("RtlConnectToSm") },
        .{"RtlSendMsgToSm", stub("RtlSendMsgToSm") },
        .{"NtQueryKey", stub("NtQueryKey") },
        .{"NtDeleteKey", stub("NtDeleteKey") },
        .{"__chkstk", stub("__chkstk") },
        .{"memcpy", stub("memcpy") },
        .{"memset", stub("memset") },
        .{"__C_specific_handler", stub("__C_specific_handler") },
    });
};
